CHARACTER*3 AAA, BBB*80
PARAMETER (JMAX=87,JM=66)
REAL*4  Z(JMAX),ZZ(JM),P(JM),T(JM),RO(JM,5), R(5)
OPEN(10,FILE='ATM&CLOUD.PROF')
DO I=1,3 
READ(10,1)AAA
1 FORMAT(A3)
END DO
DO J=1,JMAX
READ(10,*)Z(J)
END DO
CLOSE(10)

OPEN(10,FILE='Venus_5gases')
OPEN(11,FILE='Venus_5g_Cloud')

2 FORMAT(A80)
READ(10,2)BBB ; WRITE(11,2)BBB
READ(10,2)BBB ; WRITE(11,*)' 5    87'
DO I=1,5 
READ(10,1)AAA ; WRITE(11,1)AAA
END DO 

DO J=1,JM
READ(10,*)ZZ(J),P(J),T(J),RO(J,:)
END DO
CLOSE(10)

3 FORMAT(F7.2,2X,E12.5,2X,F7.2,5E14.5)
DO J=1,JMAX
ZZZ=Z(J)
 DO I=2,JM
 IF(ZZ(I)>=ZZZ)EXIT
 END DO
 C1=(ZZ(I)-ZZZ)/(ZZ(I)-ZZ(I-1)) ; C2=1.-C1
 PPP=P(I-1)*C1+P(I)*C2
 TTT=T(I-1)*C1+T(I)*C2
 R=RO(I-1,:)*C1+RO(I,:)*C2
  WRITE(11,3)ZZZ,PPP,TTT,R
END DO

END